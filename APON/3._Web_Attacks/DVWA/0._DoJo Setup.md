Security dojo setup:
https://sourceforge.net/projects/websecuritydojo/
https://www.fastvue.co/blog/testing-web-application-firewalls-with-web-security-dojo-part1-setup/

Walkthroughs:
https://github.com/mrudnitsky/dvwa-guide-2019/blob/master/low/Challenge%2001:%20Brute%20Force.md
https://bughacking.com/dvwa-ultimate-guide-first-steps-and-walkthrough/

# Web Security Dojo Configuration

### VMware Guest
```bash - target
sudo apt update
```

```bash - target
sudo apt install open-vm-tools
```

```bash -target
sudo apt update
```

```bash - target
sudo apt install open-vm-tools-desktop
```

Now reboot the machine and done.

Maven Security packaged and configured the virtual appliance as an all-in-one appliance. So you do not need to connect these vulnerable sites to your network for testing. This is great if you just want to practice with the installed tools in isolation. However, for testing Web Application Firewalls, you need to access it from something other than the 127.0.0.1 localhost. For this, we are going to explicitly change a few of the default settings.

### Task 1: Check Network Accessibility

Once your virtual appliance boots up, launch a terminal window and check the IP address with:
```bash - target
ip a
```
Confirm that you are in the correct subnet or VLAN that you require. If you are in a subnet without DHCP you can configure static addresses. Using the **Start | Settings | Network Connections** utility is the easiest.

### Task 2: Turn off the host firewalls

By default, the localhost firewall is turned on. Since some of the sites run on non-standard port numbers it is simpler to just disable the firewall.

From the terminal run the following command:
```bash - target
sudo ufw disable
```

If prompted for a password, use _dojo_ as the password.

You can check the status of the firewall with the following command:
```bash - target
sudo ufw status
```

DO NOT DO, WILL NOT BE ABLE TO ACCESS FROM KALI:
After testing you could re-enable the firewall with the following command:
```bash - target
sudo ufw enable
```

### Task 3: Apache restrictive directive configuration

By default, there is an Apache access directive in place to limit access to the Apache hosted site to only allow the localhost. If you attempt to connect from an IP address that is not the localhost you will simply get an error 403 response.

To disable this you need to edit the .htaccessfile. From a terminal shell enter the following:

```bash - target
sudo nano /var/www/.htaccess
```

Comment out all of the lines for “limit access to local area network” by adding a # in front of the lines. **Ctrl X | Y** to save the changes and exit nano.

[![Apache restrictive directive configuration](https://www.fastvue.co/wp-content/uploads/2018/05/Apache-htaccess-change.png)](https://www.fastvue.co/wp-content/uploads/2018/05/Apache-htaccess-change.png "Apache htaccess change")

To ensure that the changes are applied and persist, restart the virtual appliance with the following command.
```bash - target
reboot
```

# Attacking the Web Security Dojo

I use a Kali Linux machine as the attacking machine, but using a Windows machine is also perfectly fine. To access the different sites and services on the Dojo machine you will need to have the relevant DNS or HOST entries so that you can generate acceptable HOST headers.

Add the following entries to the relevant file (substituting the correct IP, keep the .local names exactly as they are):

```bash - target
sudo mousepad /etc/hosts
```

```bash - target
$DOJO_IP        targets.local docs.local dvwa.local nowasp.local insecure.local wavsep.local juiceshop.local cheese.local casino.local webgoat.local evil.local
```

### Testing LAN Access to the Web Security Dojo

Once the host entries are saved you should be able to connect to the Dojo machine with the following link:
```bash - target
http://targets.local
```

This will show you the list of web targets. The top 5 links are sites that are running by default so you should be able to connect to any of them. Targets like Hacme and Webgoat can be manually started on the Dojo machine.


