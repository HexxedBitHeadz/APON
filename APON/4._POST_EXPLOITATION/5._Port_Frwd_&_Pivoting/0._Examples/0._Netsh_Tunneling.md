| Host    | IP Address   |     |
| ------- | ------------ | --- |
| KALI    | 192.168.0.20 |     |
| WIN10_1 | 192.168.0.21 |     |
| WIN10_1 | 10.1.0.21    |     |
| WIN10_2 | 10.1.0.22    |     |
| UBUN_1  | 192.168.0.22 |     |
| UBUN_2  | 10.1.0.22    |     |

#### Setup
First, set up Kali with static IP:

Kali




Next, set up WIN10_1 with Bridged network adapter:

WIN10_1

Add new adapter with private IP access:

ipconfig showing both adapters, now communicating with separate Kali communication working!


Next, install tools on WIN10-1 (nc, wireshark, openssh, etc).
install vulnerable software on WIN10_2.
Disable Windows defenses in gpedit (Defender, Firewall, etc).

Test that you can nc from WIN10_1 to WIN10_2:

#### Tunneling KALI from WIN10_2

| Host | IP Address |  
| ----------- | ----------- |  
| KALI | 192.168.0.20 |  
| WIN10_1 | 192.168.0.21 |
| WIN10_1 | 10.1.0.21 |  
| WIN10_2 | 10.1.0.22 |  
| UBUN_1 | 192.168.0.22 |
| UBUN_2 | 10.1.0.22 |

ssh from kali to WIN10_1
```
ssh kali@$WIN10_1
```

#### SMTP Tunnel
Forward any traffic on Win10_1:25 **public address** to WIN10_1:25 **private address**
```
netsh interface portproxy add v4tov4 listenport=25 listenaddress=192.168.0.21 connectport=25 connectaddress=10.1.0.21
```

Forward any traffic on Win10_1:25 **private address** to WIN10_2:25 **private address**
```
netsh interface portproxy add v4tov4 listenport=25 listenaddress=10.1.0.21 connectport=25 connectaddress=10.1.0.22
```

Setting up firewall rules:
```
netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=192.168.0.21 localport=25 action=allow
```

Check your work:
```
netsh interface portproxy show all
```

Testing the forwarding:
```
nc 192.168.0.21 25
```


#### POP3 Tunnel
Forward any traffic on Win10_1:110 **public address** to WIN10_1:110 **private address**
```
netsh interface portproxy add v4tov4 listenport=110 listenaddress=192.168.0.21 connectport=110 connectaddress=10.1.0.21
```

Forward any traffic on Win10_1:25 **private address** to WIN10_2:25 **private address**
```
netsh interface portproxy add v4tov4 listenport=110 listenaddress=10.1.0.21 connectport=110 connectaddress=10.1.0.22
```

Setting up firewall rules:
```
netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=192.168.0.21 localport=110 action=allow
```

Check your work:
```
netsh interface portproxy show all
```

Testing the forwarding:
```
nc 192.168.0.21 110
```

#### Resetting port forwarding
```
netsh interface portproxy reset 
```

or 

```
netsh interface portproxy delete
```
