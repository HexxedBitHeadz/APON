**Detection**  

```command prompt - target
wmic service get name,displayname,pathname,startmode 2>nul |findstr /i "Auto" 2>nul |findstr /i /v "C:\Windows\\" 2>nul |findstr /i /v """
```

OR

```command prompt - target
wmic service get name,displayname,pathname,startmode |findstr /i /v "c:\" |findstr /i /v """
```

OR

```command prompt - target
wmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v "C:\Windows\" | findstr /i /v """
```

OR

```command prompt - target
gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | select PathName,DisplayName,Name
```

![[Pasted image 20220405163230.png]]

Here we find veyon-service.exe in user directory with a service name of VeyonService.  Taking a closer look, we can see it runs with system privileges.

```command prompt - target
sc qc VeyonService
```

![[Pasted image 20220405163548.png]]

Now just go to the BINARY_PATH_NAME directory path and test where you can write a file!

```
echo "test" > test.txt
```

[[1._Reverse Shells (WIN)#Stageless Payloads]]

Move the veyon-service.exe to a bak file, copy you're new reverse shell in it's place, restart.

[[___.Misc Commands#Restart host]]

For additional practice, it is recommended to attempt the TryHackMe room Steel Mountain ([https://tryhackme.com/room/steelmountain](https://tryhackme.com/room/steelmountain)).

